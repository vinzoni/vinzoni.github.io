<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galleria di Libri da Regalare</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2 {
            text-align: center;
            color: #2c3e50;
        }
        .book-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px 0;
        }
        .book-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .book-item:hover {
            transform: scale(1.05);
        }
        .book-cover {
            width: 150px;
            height: 200px;
            object-fit: cover;
            margin-bottom: 10px;
        }
        .book-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .book-author {
            font-style: italic;
            margin-bottom: 5px;
        }
        .book-description {
            font-size: 0.9em;
            color: #666;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }
        #searchForm {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        #searchForm input {
            margin-right: 10px;
            padding: 5px;
        }
        #searchForm button {
            padding: 5px 10px;
            background-color: #2c3e50;
            color: white;
            border: none;
            cursor: pointer;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 600px;
        }
        #exportButton {
           display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #2c3e50;
            color: white;
            border: none;
            cursor: pointer;
        }
        #exportModal .modal-content {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Galleria di Libri da Regalare</h1>
    <form id="searchForm">
        <input type="text" id="titleInput" placeholder="Titolo del libro" required>
        <input type="text" id="authorInput" placeholder="Autore del libro" required>
        <button type="submit">Cerca e Aggiungi Libro</button>
    </form>
    <button id="exportButton">Esporta Lista Libri</button>
    <div class="book-grid" id="bookGrid">
        <div class="book-item">
            <img src="http://books.google.com/books/content?id=YNjiCwAAQBAJ&amp;printsec=frontcover&amp;img=1&amp;zoom=1&amp;edge=curl&amp;source=gbs_api" alt="Il processo" class="book-cover">
            <div class="book-title">Il processo</div>
            <div class="book-author">Franz Kafka</div>
            <div class="book-description">"Il processo" appare nel 1925, un anno dopo la morte di Franz Kafka: ed è proprio con questo testo che Max Brod, suo esecutore testamentario, diede inizio alla pubblicazione postuma di scritti dell’amico, trasgredendo così alla volontà dell’autore, che lo aveva incaricato di distruggere, alla sua morte, tutte le sue carte. Kafka si era dedicato a questa narrazione, che, a voce, era solito chiamare "Il processo", durante la seconda metà del 1914, nei mesi che seguirono un avvenimento decisivo per la sua vita, la rottura del fidanzamento con Felice Bauer; nel gennaio del 1915 egli, a quanto risulta, abbandonava definitivamente l’opera. La versione del "Processo" che qui si presenta, opera di Giorgio Zampa, ha avuto il Premio Montecchio 1976 per la migliore traduzione dalla lingua tedesca apparsa negli anni 1973-1975. L’autore di essa si è proposto di restituire il carattere del testo che è quello di un «romanzo in frammenti», non sottoposto alla scrupolosa elaborazione e revisione che Kafka dedicò ai pochi scritti da lui pubblicati. In questo modo il lettore italiano potrà avvicinare "Il processo" come esso è: nella sua disadorna, immediata, terribile verità.</div>
        </div><div class="book-item">
            <img src="http://books.google.com/books/content?id=RMmxxYUBQhgC&amp;printsec=frontcover&amp;img=1&amp;zoom=1&amp;edge=curl&amp;source=gbs_api" alt="Spillover: Animal Infections and the Next Human Pandemic" class="book-cover">
            <div class="book-title">Spillover: Animal Infections and the Next Human Pandemic</div>
            <div class="book-author">David Quammen</div>
            <div class="book-description">"[Mr. Quammen] is not just among our best science writers but among our best writers, period." —Dwight Garner, New York Times The next big human pandemic—the next disease cataclysm, perhaps on the scale of AIDS or the 1918 influenza—is likely to be caused by a new virus coming to humans from wildlife. Experts call such an event “spillover” and they warn us to brace ourselves. David Quammen has tracked this subject from the jungles of Central Africa, the rooftops of Bangladesh, and the caves of southern China to the laboratories where researchers work in space suits to study lethal viruses. He illuminates the dynamics of Ebola, SARS, bird flu, Lyme disease, and other emerging threats and tells the story of AIDS and its origins as it has never before been told. Spillover reads like a mystery tale, full of mayhem and clues and questions. When the Next Big One arrives, what will it look like? From which innocent host animal will it emerge? Will we be ready?</div>
        </div>
         
    </div>

    <!-- Modal per i dettagli del libro -->
    <div id="bookModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitle"></h2>
            <p id="modalAuthor"></p>
            <img id="modalCover" src="" alt="Copertina del libro" style="max-width: 200px; margin: 10px 0;">
            <p id="modalDescription"></p>
        </div>
    </div>

    <div id="exportModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Lista dei Libri</h2>
            <p>Copia il seguente codice e incollalo nel tuo file HTML:</p>
            <pre id="exportContent"></pre>
        </div>
    </div>

    <script>
        const books = [];

        // Aggiungi questa funzione dopo la definizione dell'array 'books'
            function populateBookGrid() {
            const bookGrid = document.getElementById('bookGrid');
            bookGrid.innerHTML = ''; // Pulisce la griglia esistente
            books.forEach((book, index) => {
                bookGrid.appendChild(createBookElement(book, index));
            });
        }
        
        function exportBookList() {
            const exportContent = document.getElementById('exportContent');
            const booksArray = JSON.stringify(books, null, 2);
            exportContent.textContent = `const books = ${booksArray};

            // Chiama questa funzione quando la pagina è caricata
            window.addEventListener('load', populateBookGrid);`;
    
            document.getElementById('exportModal').style.display = 'block';
        }

// Event listener per il pulsante di esportazione
document.getElementById('exportButton').addEventListener('click', exportBookList);

// Chiusura del modal di esportazione
document.getElementById('exportModal').querySelector('.close').onclick = function() {
    document.getElementById('exportModal').style.display = 'none';
}        
        function createBookElement(book, index) {
            const bookElement = document.createElement('div');
            bookElement.classList.add('book-item');
            bookElement.innerHTML = `
                <img src="${book.cover}" alt="${book.title}" class="book-cover">
                <div class="book-title">${book.title}</div>
                <div class="book-author">${book.author}</div>
                <div class="book-description">${book.description}</div>
            `;
            bookElement.onclick = () => openModal(index);
            return bookElement;
        }

        function populateBookGrid() {
            const bookGrid = document.getElementById('bookGrid');
            bookGrid.innerHTML = ''; // Pulisce la griglia esistente
            books.forEach((book, index) => {
                bookGrid.appendChild(createBookElement(book, index));
            });
        }

        async function searchBook(title, author) {
            const query = `intitle:${title}+inauthor:${author}`;
            const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(query)}`);
            const data = await response.json();
        
            if (data.items && data.items.length > 0) {
                const bookInfo = data.items[0].volumeInfo;
                return {
                    title: bookInfo.title,
                    author: bookInfo.authors ? bookInfo.authors.join(', ') : 'Autore sconosciuto',
                    description: bookInfo.description || 'Nessuna descrizione disponibile',
                    cover: bookInfo.imageLinks ? bookInfo.imageLinks.thumbnail : '/api/placeholder/150/200'
                };
            }
            return null;
        }

        document.getElementById('searchForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const title = document.getElementById('titleInput').value;
            const author = document.getElementById('authorInput').value;
            
            const book = await searchBook(title, author);
            if (book) {
                books.push(book);
                populateBookGrid();
                document.getElementById('titleInput').value = '';
                document.getElementById('authorInput').value = '';
            } else {
                alert('Libro non trovato. Prova a cercare con termini diversi.');
            }
        });

        // Funzionalità del modal
        const modal = document.getElementById("bookModal");
        const span = document.getElementsByClassName("close")[0];

        function openModal(index) {
            const book = books[index];
            document.getElementById("modalTitle").textContent = book.title;
            document.getElementById("modalAuthor").textContent = book.author;
            document.getElementById("modalCover").src = book.cover;
            document.getElementById("modalDescription").textContent = book.description;
            modal.style.display = "block";
        }

        span.onclick = function() {
            modal.style.display = "none";
        }

        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>
</body>
</html>
